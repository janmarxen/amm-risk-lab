The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) Stages/2025

The following have been reloaded with a version change:
  1) sympy/1.13.3 => sympy/1.13.1

Traceback (most recent call last):
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 214, in <module>
Traceback (most recent call last):
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 214, in <module>
Traceback (most recent call last):
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 214, in <module>
    main()
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 22, in main
    main()
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 22, in main
    main()
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 22, in main
    rank, world_size, device = setup()
                               ^^^^^^^
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/utils/distributed_utils.py", line 12, in setup
    rank, world_size, device = setup()
                               ^^^^^^^
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/utils/distributed_utils.py", line 12, in setup
    rank, world_size, device = setup()
                               ^^^^^^^
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/utils/distributed_utils.py", line 12, in setup
Traceback (most recent call last):
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 214, in <module>
    main()
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/ml/PLV/scripts/run_dist_gridsearch.py", line 22, in main
    torch.distributed.init_process_group(backend='nccl')
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 83, in wrapper
    rank, world_size, device = setup()
                               ^^^^^^^
    torch.distributed.init_process_group(backend='nccl')
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 83, in wrapper
    torch.distributed.init_process_group(backend='nccl')
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 83, in wrapper
  File "/p/project1/training2529/marxen1/amm-risk-lab/python/utils/distributed_utils.py", line 12, in setup
    torch.distributed.init_process_group(backend='nccl')
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 83, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 97, in wrapper
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 97, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 97, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/c10d_logger.py", line 97, in wrapper
    func_return = func(*args, **kwargs)
    func_return = func(*args, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py", line 1520, in init_process_group
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py", line 1520, in init_process_group
    func_return = func(*args, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py", line 1520, in init_process_group
    func_return = func(*args, **kwargs)
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py", line 1520, in init_process_group
    store, rank, world_size = next(rendezvous_iterator)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store, rank, world_size = next(rendezvous_iterator)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store, rank, world_size = next(rendezvous_iterator)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    store, rank, world_size = next(rendezvous_iterator)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 258, in _env_rendezvous_handler
    rank = int(_get_env_or_raise("RANK"))
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 243, in _get_env_or_raise
    rank = int(_get_env_or_raise("RANK"))
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 243, in _get_env_or_raise
    rank = int(_get_env_or_raise("RANK"))
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 243, in _get_env_or_raise
    raise _env_error(env_var)
ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
    rank = int(_get_env_or_raise("RANK"))
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/p/software/default/stages/2025/software/PyTorch/2.5.1-gcccoreflexiblas-13.3.0-3.4.4/lib/python3.12/site-packages/torch/distributed/rendezvous.py", line 243, in _get_env_or_raise
    raise _env_error(env_var)
ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
    raise _env_error(env_var)
ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
    raise _env_error(env_var)
ValueError: Error initializing torch.distributed using env:// rendezvous: environment variable RANK expected, but not set
srun: error: jrc0228: tasks 0-3: Exited with exit code 1
